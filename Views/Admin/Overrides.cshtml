@model List<Trash_Track.Models.PickupOverride>

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Pickup Overrides</h2>
    <a asp-action="CreateOverride" class="btn btn-primary">
        <i class="bi bi-plus-circle me-1"></i> Create Override
    </a>
</div>

<table class="table table-bordered">
    <thead>
        <tr>
            <th>Ward</th>
            <th>From</th>
            <th>To</th>
            <th>Pickup Day</th>
            <th>Pickup Time</th>
            <th>Cancelled?</th>
            <th>Driver</th>
            <th>Remarks</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            var schedule = item.Ward?.PickupSchedule;
            var pickupDay = item.OverrideDay?.ToString() ?? schedule?.PickupDay.ToString() ?? "N/A";
            var pickupTime = item.NewTime?.ToString(@"hh\:mm") ?? schedule?.PickupTime.ToString(@"hh\:mm") ?? "-";
            var driverName = item.Driver?.Name ?? schedule?.Driver?.Name ?? "Unassigned";

            <tr>
                <td>Ward @item.Ward.No - @item.Ward.Name</td>
                <td>@item.StartDate.ToShortDateString()</td>
                <td>@item.EndDate.ToShortDateString()</td>
                <td>@pickupDay</td>
                <td>@pickupTime</td>
                <td>
                    @if (item.IsCancelled)
                    {
                        <span class="badge bg-danger">Yes</span>
                    }
                    else
                    {
                        <span class="badge bg-success">No</span>
                    }
                </td>
                <td>@driverName</td>
                <td>@item.Message</td>
                <td>
                    <a asp-action="EditOverride" asp-route-id="@item.Id" class="btn btn-warning btn-sm">Edit</a>
                    <a asp-action="DeleteOverride" asp-route-id="@item.Id" class="btn btn-danger btn-sm">Delete</a>
                </td>
            </tr>
        }
    </tbody>
</table>
